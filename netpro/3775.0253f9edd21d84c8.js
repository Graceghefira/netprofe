"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3775],{69445:(O,m,n)=>{n.d(m,{$:()=>h});var d=n(14085),g=n(87122),i=n(54438);const x=[[["","fuseCardFront",""]],[["","fuseCardBack",""]],"*",[["","fuseCardExpansion",""]]],b=["[fuseCardFront]","[fuseCardBack]","*","[fuseCardExpansion]"];function w(r,v){1&r&&(i.j41(0,"div",0),i.SdG(1),i.k0s(),i.j41(2,"div",1),i.SdG(3,1),i.k0s())}function F(r,v){1&r&&(i.j41(0,"div",2),i.SdG(1,3),i.k0s()),2&r&&i.Y8G("@expandCollapse",void 0)}function C(r,v){if(1&r&&(i.SdG(0,2),i.DNE(1,F,2,1,"div",2)),2&r){const l=i.XpG();i.R7$(),i.vxM(l.expanded?1:-1)}}let h=(()=>{class r{constructor(){this.expanded=!1,this.face="front",this.flippable=!1}get classList(){return{"fuse-card-expanded":this.expanded,"fuse-card-face-back":this.flippable&&"back"===this.face,"fuse-card-face-front":this.flippable&&"front"===this.face,"fuse-card-flippable":this.flippable}}ngOnChanges(l){"expanded"in l&&(this.expanded=(0,d.he)(l.expanded.currentValue)),"flippable"in l&&(this.flippable=(0,d.he)(l.flippable.currentValue))}static{this.\u0275fac=function(p){return new(p||r)}}static{this.\u0275cmp=i.VBU({type:r,selectors:[["fuse-card"]],hostVars:2,hostBindings:function(p,u){2&p&&i.HbH(u.classList)},inputs:{expanded:"expanded",face:"face",flippable:"flippable"},exportAs:["fuseCard"],features:[i.OA$],ngContentSelectors:b,decls:2,vars:2,consts:[[1,"fuse-card-front"],[1,"fuse-card-back"],[1,"fuse-card-expansion"]],template:function(p,u){1&p&&(i.NAR(x),i.DNE(0,w,4,0)(1,C,2,1)),2&p&&(i.vxM(u.flippable?0:-1),i.R7$(),i.vxM(u.flippable?-1:1))},styles:["fuse-card{position:relative;display:flex;overflow:hidden;--tw-bg-opacity: 1;background-color:rgba(var(--fuse-bg-card-rgb),var(--tw-bg-opacity));border-radius:1rem;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable{border-radius:0;overflow:visible;transform-style:preserve-3d;transition:transform 1s;perspective:600px;background:transparent;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable.fuse-card-face-back .fuse-card-front{visibility:hidden;opacity:0;transform:rotateY(180deg)}fuse-card.fuse-card-flippable.fuse-card-face-back .fuse-card-back{visibility:visible;opacity:1;transform:rotateY(360deg)}fuse-card.fuse-card-flippable .fuse-card-front,fuse-card.fuse-card-flippable .fuse-card-back{display:flex;flex-direction:column;flex:1 1 auto;z-index:10;transition:transform .5s ease-out 0s,visibility 0s ease-in .2s,opacity 0s ease-in .2s;backface-visibility:hidden;--tw-bg-opacity: 1;background-color:rgba(var(--fuse-bg-card-rgb),var(--tw-bg-opacity));border-radius:1rem;--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}fuse-card.fuse-card-flippable .fuse-card-front{position:relative;opacity:1;visibility:visible;transform:rotateY(0);overflow:hidden}fuse-card.fuse-card-flippable .fuse-card-back{position:absolute;inset:0;opacity:0;visibility:hidden;transform:rotateY(180deg);overflow:hidden auto}\n"],encapsulation:2,data:{animation:g.X}})}}return r})()},61843:(O,m,n)=>{n.d(m,{$:()=>d.$});var d=n(69445)},53775:(O,m,n)=>{n.r(m),n.d(m,{default:()=>W});var d=n(60177),g=n(88834),i=n(99213),x=n(96695),b=n(49192),w=n(61843),F=n(9159),C=n(22080),h=n(84412),r=n(21413),v=n(84572),l=n(56977),p=n(96354),u=n(44549),t=n(54438),$=n(10467),G=n(51373),y=n(77502),I=n(95084),k=n(45794);let R=(()=>{class a{constructor(){this.apiUrl=y.c.apiUrl,this.toast=(0,t.WQX)(k.tw),this._NetproNetwach=new h.t([]),this.netpro$=this._NetproNetwach.asObservable(),this._ImagoNetwach=new h.t([]),this.imago$=this._ImagoNetwach.asObservable(),this._WowNetwach=new h.t([]),this.Wow$=this._WowNetwach.asObservable(),this.initMqtt()}initMqtt(){this.client=I.A.connect("wss://netpro.awh.co.id:8083/mqtt",{username:y.c.mqtt.username,password:y.c.mqtt.password}),this.client.on("connect",()=>{console.log("MQTT connected"),this.client.subscribe("Netpro/netwatch-status",e=>{e&&(console.error("Failed to subscribe:",e),this.toast.error(e.message,"Error Subscribing"))}),this.client.subscribe("imago/netwatch-status",e=>{e&&(console.error("Failed to subscribe:",e),this.toast.error(e.message,"Error Subscribing"))}),this.client.subscribe("Wow/netwatch-status",e=>{e&&(console.error("Failed to subscribe:",e),this.toast.error(e.message,"Error Subscribing"))})}),this.client.on("message",(e,s)=>{"Netpro/netwatch-status"===e?this.handleMessage(s.toString(),this._NetproNetwach):"imago/netwatch-status"===e?this.handleMessage(s.toString(),this._ImagoNetwach):"Wow/netwatch-status"===e&&this.handleMessage(s.toString(),this._WowNetwach)}),this.client.on("close",()=>{console.warn("MQTT connection closed, attempting to reconnect..."),setTimeout(()=>{this.client.reconnect()},1e3)})}handleMessage(e,s){try{const o=JSON.parse(e);s.next(o)}catch(o){console.error("Error parsing message:",o),this.toast.error("Invalid data received","Error")}}get(e){var s=this;return(0,$.A)(function*(){return yield G.A.get(s.apiUrl+"api-netpro/api/"+e).then(function(){var o=(0,$.A)(function*(f){return f.data});return function(f){return o.apply(this,arguments)}}()).catch(function(){var o=(0,$.A)(function*(f){return console.log(f),f});return function(f){return o.apply(this,arguments)}}())})()}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var S=n(32209);const N=()=>[1,2];function T(a,c){1&a&&t.nrm(0,"ion-skeleton-text",9),2&a&&t.Y8G("animated",!0)}function Y(a,c){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.type)}}function j(a,c){1&a&&t.nrm(0,"ion-skeleton-text",10),2&a&&t.Y8G("animated",!0)}function _(a,c){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(),t.SpI(" Board Name : ","Netpro"===e.type?"RB450Gx4":"Imago"===e.type?"RB951Ui-2nD":"-----"," ")}}function M(a,c){if(1&a&&(t.j41(0,"li",12)(1,"p"),t.nrm(2,"ion-skeleton-text",13),t.k0s(),t.j41(3,"p"),t.nrm(4,"ion-skeleton-text",13),t.k0s(),t.j41(5,"p"),t.nrm(6,"ion-skeleton-text",13),t.k0s(),t.j41(7,"p"),t.nrm(8,"ion-skeleton-text",13),t.k0s()()),2&a){const e=t.XpG(3);t.Y8G("ngClass",0===e.i?"":"pt-5 flex flex-col"),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0),t.R7$(2),t.Y8G("animated",!0)}}function D(a,c){1&a&&(t.j41(0,"ul"),t.DNE(1,M,9,5,"li",11),t.k0s()),2&a&&(t.R7$(),t.Y8G("ngForOf",t.lJ4(1,N)))}function L(a,c){if(1&a&&(t.j41(0,"li",12)(1,"p"),t.EFF(2),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s()()),2&a){const e=c.$implicit,s=c.index;t.Y8G("ngClass",0===s?"":"pt-5"),t.R7$(2),t.Lme("",0===s?"Main":"Backup"," : ",null==e?null:e.host,""),t.R7$(2),t.SpI("Status : ",null==e?null:e.status,""),t.R7$(2),t.SpI("Timeout : ",null===(null==e?null:e.timeout)?"Not Found":null==e?null:e.timeout,""),t.R7$(2),t.SpI("Interval : ",null===(null==e?null:e.interval)?"Not Found":null==e?null:e.interval,"")}}function B(a,c){if(1&a&&(t.j41(0,"ul"),t.DNE(1,L,9,6,"li",11),t.k0s()),2&a){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ngForOf",e.data)}}function U(a,c){1&a&&(t.j41(0,"div")(1,"p"),t.EFF(2,"Data tidak ditemukan."),t.k0s()())}function A(a,c){if(1&a&&(t.j41(0,"fuse-card",3)(1,"div")(2,"h1",4),t.DNE(3,T,1,1,"ion-skeleton-text",5)(4,Y,2,1,"span",6),t.k0s(),t.j41(5,"p",7),t.DNE(6,j,1,1,"ion-skeleton-text",8)(7,_,2,1,"span",6),t.k0s()(),t.DNE(8,D,2,2,"ul",6)(9,B,2,1,"ul",6)(10,U,3,0,"div",6),t.k0s()),2&a){const e=c.$implicit,s=t.XpG();t.R7$(3),t.Y8G("ngIf",s.isLoading),t.R7$(),t.Y8G("ngIf",!s.isLoading),t.R7$(2),t.Y8G("ngIf",s.isLoading),t.R7$(),t.Y8G("ngIf",!s.isLoading),t.R7$(),t.Y8G("ngIf",!s.isLoading&&!e.data),t.R7$(),t.Y8G("ngIf",!s.isLoading&&e.data),t.R7$(),t.Y8G("ngIf",s.isLoading&&!e.data)}}const W=[{path:"",component:(()=>{class a{constructor(e,s){this.failOverServices=e,this._notificationService=s,this.data$=new h.t([]),this.isLoading=!0,this.destroy$=new r.B}ngOnInit(){const e=u.c9.now();try{(0,v.z)([this.failOverServices.imago$,this.failOverServices.netpro$,this.failOverServices.Wow$]).pipe((0,l.Q)(this.destroy$)).subscribe(([s,o,f])=>{this.data$.next([{type:"Imago",data:s.netwatch},{type:"Netpro",data:o.netwatch},{type:"Wow",data:f.netwatch}])}),this._notificationService.getAll().pipe((0,p.T)(s=>s.map(o=>({...o,time:u.c9.fromISO(o.time).toRelative()})))).subscribe(s=>{this.data$.subscribe(o=>{s.find(E=>"Fail Over"===E.title)||this._notificationService.create({id:null,icon:"error",title:"Fail Over",description:"Fail Over Service is down",time:e.minus({minute:25}).toISO(),read:!1}).subscribe()})})}catch(s){console.error(s)}finally{this.isLoading=!1}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(s){return new(s||a)(t.rXU(R),t.rXU(S.I))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-fail-over"]],decls:4,vars:3,consts:[[1,"p-5","mb-20","sm:mb-20","w-full"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-3"],["class","flex flex-col p-6 pb-4 gap-5",4,"ngFor","ngForOf"],[1,"flex","flex-col","p-6","pb-4","gap-5"],[1,"font-semibold","text-xl"],["style","width: 80px",3,"animated",4,"ngIf"],[4,"ngIf"],[1,"text-sm","font-medium","opacity-50"],["style","width: 150px",3,"animated",4,"ngIf"],[2,"width","80px",3,"animated"],[2,"width","150px",3,"animated"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[3,"animated"]],template:function(s,o){1&s&&(t.j41(0,"main",0)(1,"section",1),t.DNE(2,A,11,7,"fuse-card",2),t.nI1(3,"async"),t.k0s()()),2&s&&(t.R7$(2),t.Y8G("ngForOf",t.bMT(3,1,o.data$)))},dependencies:[i.m_,b.iI,x.Ou,g.Hl,d.MD,d.YU,d.Sq,d.bT,d.Jj,w.$,F.tP,C.ds],encapsulation:2})}}return a})()}]}}]);