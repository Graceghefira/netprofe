"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[2979],{72979:(I,r,o)=>{o.r(r),o.d(r,{default:()=>D});var l=o(10467),c=o(88834),m=o(99213),d=o(31849),u=o(44742),g=o(60177),p=o(74950),h=o(90882),v=o(21413),e=o(54438),a=o(77502),f=o(95084),F=o(45794),M=o(84412),S=o(25798);let j=(()=>{class i{constructor(n){this.userService=n,this.apiUrl=a.c.apiUrl,this.toast=(0,e.WQX)(F.tw),this._deviceSubject=new M.t([]),this.device$=this._deviceSubject.asObservable(),this.initMqtt()}initMqtt(){this.client=f.A.connect("wss://netpro.awh.co.id:8083/mqtt",{username:a.c.mqtt.username,password:a.c.mqtt.password}),this.client.on("connect",()=>{console.log("MQTT connected"),this.userService.topic$.subscribe(n=>{this.client.subscribe(`${"Netpro"===n?"mikrotik":n}/get-device`,t=>{t&&(console.error("Failed to subscribe:",t),this.toast.error(t.message,"Error Subscribing"))})})}),this.client.on("message",(n,t)=>{this.userService.topic$.subscribe(s=>{n===`${"Netpro"===s?"mikrotik":s}/get-device`&&this.handleHotspotProfileMessage(t.toString())})}),this.client.on("close",()=>{console.warn("MQTT connection closed, attempting to reconnect..."),setTimeout(()=>{this.client.reconnect()},1e3)})}handleHotspotProfileMessage(n){try{const t=JSON.parse(n);this._deviceSubject.next(t)}catch(t){console.error("Error parsing message:",t),this.toast.error("Invalid data received","Error")}}disconnect(){this.client&&this.client.end(!0)}static{this.\u0275fac=function(t){return new(t||i)(e.KVO(S.D))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var y=o(3366);(0,p.u2)(window);const D=[{path:"",component:(()=>{class i{constructor(n,t){this.homeService=n,this._apiService=t,this.unsubscribe$=new v.B}ngOnInit(){this.fetchDevice()}fetchDevice(){var n=this;return(0,l.A)(function*(){const t=yield n._apiService.get("/api/mikrotik/get-info",!0);n.message=t})()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete(),this.homeService.disconnect()}getFormattedMemory(n){const t=parseFloat(n)/1048576;return t>=1e3?(t/1024).toFixed(1)+" GiB":t.toFixed(1)+" MiB"}static{this.\u0275fac=function(t){return new(t||i)(e.rXU(j),e.rXU(y.G))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-home"]],decls:46,vars:9,consts:[["fuseCard",""],[1,"w-full","h-fit","pb-13"],[1,"dark","relative","flex-0","overflow-hidden","bg-[url('assets/img/home-bg.png')]","px-4","sm:p-16"],[1,"relative","z-10","flex","flex-col","items-center","py-20"],[1,"text-4xl","font-bold"],[1,"text-secondary","font-semibold","max-w-2xl","tracking-tight","sm:text-2xl"],[1,"grid-cols-1","md:grid-cols-2","lg:grid-cols-2","grid","px-4","py-4","gap-4"],[1,"flex","flex-col","px-8","py-6","pb-4"],[1,"flex","items-center","gap-5"],["svgIcon","heroicons_solid:calendar-days",2,"width","48px","height","48px"],[1,"mt-2"],[1,"font-medium"],["svgIcon","heroicons_solid:information-circle",2,"width","48px","height","48px"],["svgIcon","heroicons_solid:cpu-chip",2,"width","48px","height","48px"],[1,"flex","gap-2"]],template:function(t,s){1&t&&(e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),e.EFF(4,"NetPro Connect"),e.k0s(),e.j41(5,"div",5),e.EFF(6," Empower Your Network Control in Your Hands "),e.k0s()()(),e.j41(7,"div",6)(8,"fuse-card",7,0)(10,"section",8),e.nrm(11,"mat-icon",9),e.j41(12,"div",10)(13,"p",11),e.EFF(14),e.k0s(),e.j41(15,"p",11),e.EFF(16),e.k0s(),e.j41(17,"p",11),e.EFF(18),e.k0s(),e.j41(19,"p",11),e.EFF(20),e.k0s()()()(),e.j41(21,"fuse-card",7,0)(23,"section",8),e.nrm(24,"mat-icon",12),e.j41(25,"div",10)(26,"p",11),e.EFF(27),e.k0s(),e.j41(28,"p",11),e.EFF(29),e.k0s()()()(),e.j41(30,"fuse-card",7,0)(32,"section",8),e.nrm(33,"mat-icon",13),e.j41(34,"div",10)(35,"p",11),e.EFF(36),e.k0s(),e.j41(37,"p",11),e.EFF(38),e.k0s(),e.j41(39,"p",11),e.EFF(40),e.k0s(),e.j41(41,"div",14)(42,"p",11),e.EFF(43,"Voltage: 24.7V"),e.k0s(),e.j41(44,"p",11),e.EFF(45,"Temp: 31C"),e.k0s()()()()()()()),2&t&&(e.R7$(14),e.SpI("Date : ",null!=s.message&&s.message.date?s.message.date:"Memuat Data...",""),e.R7$(2),e.SpI("Time : ",null!=s.message&&s.message.time?s.message.time:"Memuat Data...",""),e.R7$(2),e.SpI("Uptime : ",null!=s.message&&s.message.upTime?s.message.upTime:"Memuat Data...",""),e.R7$(2),e.SpI("Time Zone : ",null!=s.message&&s.message.upTime?s.message.upTime:"Memuat Data...",""),e.R7$(7),e.SpI("Model : ",null!=s.message&&s.message.model?s.message.model:"Memuat Data...",""),e.R7$(2),e.SpI("Router OS : ",null!=s.message&&s.message.rosVersion?s.message.rosVersion:"Memuat Data..."," "),e.R7$(7),e.SpI("CPU Load : ",null!=s.message&&s.message.cpuLoad?s.message.cpuLoad:"Memuat Data...","%"),e.R7$(2),e.SpI("Free Memory : ",s.getFormattedMemory(null!=s.message&&s.message.freeMemory?s.message.freeMemory:"Memuat Data..."),""),e.R7$(2),e.SpI("Free HDD : ",null!=s.message&&s.message.freeHdd?s.message.freeHdd+" kib":"Memuat Data..."," "))},dependencies:[d.$,m.m_,m.An,c.Hl,u.bv,g.MD,h.vg],encapsulation:2})}}return i})()}]}}]);