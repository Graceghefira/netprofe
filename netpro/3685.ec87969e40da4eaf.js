"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[3685],{3685:(ee,F,l)=>{l.r(F),l.d(F,{default:()=>q});var D=l(10467),p=l(60177),m=l(89417),C=l(88834),b=l(82765),f=l(25084),u=l(30636),S=l(99213),h=l(59115),g=l(96695),y=l(90882),j=l(2042),d=l(9159),E=l(31849),e=l(54438),T=l(80507),P=l(3366),M=l(45794);const R=()=>({disableClose:!0}),G=()=>[5,10,20];function $(a,i){if(1&a){const t=e.RV6();e.j41(0,"div",54)(1,"mat-checkbox",55),e.mxI("ngModelChange",function(o){const n=e.eBV(t).$implicit;return e.DH7(n.checked,o)||(n.checked=o),e.Njj(o)}),e.bIt("click",function(o){return e.eBV(t),e.Njj(o.stopPropagation())})("change",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.applyFilterUserProfile())}),e.j41(2,"span",56),e.EFF(3),e.k0s()()()}if(2&a){const t=i.$implicit;e.R7$(),e.R50("ngModel",t.checked),e.R7$(2),e.JRh(t.name)}}function I(a,i){1&a&&(e.j41(0,"div",57),e.nrm(1,"div",58)(2,"div",58)(3,"div",58)(4,"div",58)(5,"div",58)(6,"div",58)(7,"div",59),e.k0s())}function N(a,i){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Name "),e.k0s())}function L(a,i){1&a&&(e.j41(0,"div",57),e.nrm(1,"div",58),e.k0s())}function Y(a,i){if(1&a&&(e.j41(0,"mat-cell",71),e.EFF(1),e.k0s()),2&a){const t=i.$implicit;e.R7$(),e.SpI(" ",t.user_name," ")}}function U(a,i){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," User Profile "),e.k0s())}function V(a,i){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=i.$implicit;e.R7$(),e.SpI(" ",t.role," ")}}function A(a,i){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Download "),e.k0s())}function X(a,i){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=i.$implicit,r=e.XpG(2);e.R7$(),e.SpI(" ",r.formatBytesAuto(t.total_bytes_in)," ")}}function O(a,i){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Upload "),e.k0s())}function J(a,i){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=i.$implicit,r=e.XpG(2);e.R7$(),e.SpI(" ",r.formatBytesAuto(t.total_bytes_out)," ")}}function H(a,i){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Total Bandwidth "),e.k0s())}function K(a,i){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=i.$implicit,r=e.XpG(2);e.R7$(),e.SpI("",r.formatBytesAuto(t.total_user_bytes)," ")}}function z(a,i){1&a&&e.nrm(0,"mat-header-row")}function Z(a,i){1&a&&e.nrm(0,"mat-row")}function Q(a,i){if(1&a&&(e.j41(0,"mat-table",60,5)(2,"div"),e.qex(3,61),e.DNE(4,N,2,0,"mat-header-cell",62)(5,L,2,0,"div",49)(6,Y,2,1,"mat-cell",63),e.bVm(),e.qex(7,64),e.DNE(8,U,2,0,"mat-header-cell",62)(9,V,2,1,"mat-cell",65),e.bVm(),e.qex(10,66),e.DNE(11,A,2,0,"mat-header-cell",62)(12,X,2,1,"mat-cell",65),e.bVm(),e.qex(13,67),e.DNE(14,O,2,0,"mat-header-cell",62)(15,J,2,1,"mat-cell",65),e.bVm(),e.qex(16,68),e.DNE(17,H,2,0,"mat-header-cell",62)(18,K,2,1,"mat-cell",65),e.bVm(),e.DNE(19,z,1,0,"mat-header-row",69)(20,Z,1,0,"mat-row",70),e.k0s()()),2&a){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(5),e.Y8G("ngIf",t.isLoading),e.R7$(14),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function W(a,i){1&a&&(e.j41(0,"div",72)(1,"div",73),e.nrm(2,"img",74),e.j41(3,"h1",75),e.EFF(4,"Data Not Found"),e.k0s()()())}const v=new Date,k=v.getMonth(),B=v.getFullYear(),q=(v.getDay(),[{path:"",component:(()=>{class a{constructor(t,r,o,n){this.fuseLoadingService=t,this.cdr=r,this._apiService=o,this._toastService=n,this.range=new m.gE({start:new m.MJ(new Date(B,k)),end:new m.MJ(new Date)}),this.profileItems=[],this.displayedColumns=["name","user_profile","download","upload","total_bandwidth"],this.dataSource=new d.I6,this.drawerMode="side",this.drawerOpened=!0,this.pagedRoleDatas=[],this.userDatas=[],this.pageSize=5,this.currentPage=1,this.selectedUser=null,this.totalBandwidthMax=1e9,this.startDates=new Date(B,k).toLocaleDateString("en-CA"),this.endDates=(new Date).toLocaleDateString("en-CA"),this.isNotDataFound=!1,this.isLoading=!1,this.filterValues={profile:[],search:""},this.range.get("end")?.valueChanges.subscribe(s=>{const c=this.range.get("start")?.value;if(c&&s){console.log(c,s);const w=c instanceof Date?c:new Date(c),_=s instanceof Date?s:new Date(s);this.startDates=w.toLocaleDateString("en-CA"),this.endDates=_.toLocaleDateString("en-CA"),this.fetcData(this.startDates,this.endDates,!0)}})}applyFilter(){this.dataSource.filterPredicate=(t,r)=>{let o=JSON.parse(r),n=""===o.search||t.user_name.toLowerCase().includes(o.search),s=0===o.profile.length||o.profile.includes(t.role.toLowerCase());return n&&s},this.dataSource.filter=JSON.stringify(this.filterValues),this.isNotDataFound=0===this.dataSource.filteredData.length}applySearchFilter(t){this.filterValues.search=t.trim().toLowerCase(),this.applyFilter()}applyFilterUserProfile(){this.filterValues.profile=this.profileItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}getProfile(){var t=this;return(0,D.A)(function*(){try{(yield t._apiService.get("/api/mikrotik/get-profile",!0)).profiles.map(o=>{t.profileItems.push({name:o.profile_name,checked:!1})})}catch{t._toastService.error("Failed Fetch Data","Error")}})()}getFormattedDateTime(){const t=new Date,r=x=>x<10?"0"+x:x;return`${t.getFullYear()} - ${r(t.getMonth()+1)} - ${r(t.getDate())} ${r(t.getHours())}.${r(t.getMinutes())}.${r(t.getSeconds())}`}updateTimeRealTime(){setInterval(()=>{this.timeNow=this.getFormattedDateTime(),this.cdr.detectChanges()},100)}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}convertBytesToMB(t){return parseFloat(t)/1048576}formatBytesAuto(t){return t>=1099511627776?(t/1099511627776).toFixed(2)+" TB":t>=1073741824?(t/1073741824).toFixed(2)+" GB":t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" B"}ngOnInit(){try{this.fuseLoadingService.show(),this.totalUser="Memuat Data ",this.totalUserBandwith="Memuat Data ",this.fetcData(this.startDates,this.endDates,!0),this.updateTimeRealTime(),this.getProfile()}catch(t){throw this.fuseLoadingService.hide(),this._toastService.error("Internal Server Error","Error Fetch Data"),t}finally{this.fuseLoadingService.hide()}}fetcData(t,r,o){var n=this;return(0,D.A)(function*(){try{n.isLoading=o;const s=yield n._apiService.post("/api/mikrotik/get-data-by-date-full",{startDate:t,endDate:r});0===s.users.length?(n.isNotDataFound=!0,n.isLoading=!1):(n.isNotDataFound=!1,n.isLoading=!1),n.dataSource.data=s.users,n.totalUser=n.dataSource.data.length}catch(s){throw n._toastService.error("Internal Server Error","Error"),n.isNotDataFound=!1,n.isLoading=!1,s}})()}static{this.\u0275fac=function(r){return new(r||a)(e.rXU(T.X),e.rXU(e.gRc),e.rXU(P.G),e.rXU(M.tw))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-bandwith-profile"]],viewQuery:function(r,o){if(1&r&&(e.GBs(j.B4,5),e.GBs(g.iy,5)),2&r){let n;e.mGM(n=e.lsd())&&(o.sort=n.first),e.mGM(n=e.lsd())&&(o.paginator=n.first)}},decls:79,vars:18,consts:[["fuseCard",""],["picker",""],["menu","matMenu"],["products","matMenu"],["paginator",""],["table",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"h-full"],[1,"h-full","p-4","overflow-y-scroll"],[1,"px-4","py-4","flex","justify-between","items-center"],[1,"font-bold","text-lg","sm:text-3xl"],[1,"text-sm","sm:text-base"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-gray-500"],[1,"mx-2","text-gray-400"],[1,"font-semibold","text-blue-600","hover:text-blue-500","truncate"],[1,"grid-cols-1","sm:grid-cols-2","grid","gap-3","px-3"],[1,"flex","flex-col","px-8","py-6","shadow-lg"],[1,"my-5","bg-neutral-100","p-6","rounded-lg"],[3,"rangePicker","formGroup"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date"],["matSuffix","",3,"for"],[1,"grid","grid-cols-1","gap-3"],[1,"flex","flex-col","px-8","py-6","pb-4","shadow-lg"],[1,"text-xl","font-bold"],[1,"mt-2"],[1,"font-medium"],[1,"flex","flex-col","px-8","py-6","pb-4","shadow-lg","bg-slate-800","text-white"],[1,"p-3","overflow-y-hidden"],[1,"bg-card","flex","flex-col","overflow-hidden","rounded-2xl","h-fit","w-full","p-4","shadow-lg","sm:col-span-6"],[1,"truncate","text-lg","flex-col","sm:flex-row","font-medium","leading-6","tracking-tight","px-5","py-3","flex","items-start","sm:items-center","w-full","justify-between"],["for","table-search",1,"sr-only"],[1,"relative","my-2"],[1,"absolute","inset-y-0","rtl:inset-r-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"],["type","text","matInput","","placeholder","Search Vouchers",1,"block","p-2","ps-10","text-sm","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"keyup"],[1,"flex","items-center","gap-2","flex-row","mt-2"],[1,"flex","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","border-[1px]","text-white",3,"matMenuTriggerFor","disabled"],["svgIcon","filter_alt"],[1,"max-sm:hidden","text-base","font-semibold","text-black"],["svgIcon","keyboard_arrow_down"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"px-5","py-3"],[1,"font-semibold","mb-2"],[1,"px-5","py-2","min-w-[200px]"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],[1,"py-2","sm:px-4","overflow-y-hidden"],["role","status","class","p-5 animate-pulse",4,"ngIf"],[1,"relative","overflow-x-auto","sm:rounded-lg"],["matSort","","class","min-w-160 max-sm:min-w-128",3,"dataSource",4,"ngIf"],["class","my-10",4,"ngIf"],[3,"pageSize","pageSizeOptions","showFirstLastButtons"],[1,"flex","items-center","gap-2"],[1,"w-full",3,"ngModelChange","click","change","ngModel"],[1,"truncate","block"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full"],["matSort","",1,"min-w-160","max-sm:min-w-128",3,"dataSource"],["matColumnDef","name"],[4,"matHeaderCellDef"],["class","py-4 font-medium",4,"matCellDef"],["matColumnDef","user_profile"],[4,"matCellDef"],["matColumnDef","download"],["matColumnDef","upload"],["matColumnDef","total_bandwidth"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"py-4","font-medium"],[1,"my-10"],[1,"flex","flex-col","items-center"],["src","../../../../../assets/not-found.jpg","alt","not-found.jpg",1,"h-64","bg-cover","bg-center","object-scale-down"],[1,"mt-2","font-semibold","text-xl","-tracking-tighter"]],template:function(r,o){if(1&r){const n=e.RV6();e.j41(0,"div",6)(1,"mat-sidenav-container",7)(2,"mat-sidenav-content",8)(3,"div",9)(4,"div")(5,"h1",10),e.EFF(6,"Voucher Usage"),e.k0s(),e.j41(7,"p",11),e.EFF(8,"Voucher Usage Information"),e.k0s()(),e.j41(9,"div",12)(10,"span",13),e.EFF(11,"Home"),e.k0s(),e.j41(12,"span",14),e.EFF(13,"/"),e.k0s(),e.j41(14,"span",15),e.EFF(15,"Voucher Usage"),e.k0s()()(),e.j41(16,"div",16)(17,"fuse-card",17,0)(19,"mat-form-field",18)(20,"mat-label"),e.EFF(21,"Enter a date range"),e.k0s(),e.j41(22,"mat-date-range-input",19),e.nrm(23,"input",20)(24,"input",21),e.k0s(),e.j41(25,"mat-hint"),e.EFF(26,"MM/DD/YYYY \u2013 MM/DD/YYYY"),e.k0s(),e.nrm(27,"mat-datepicker-toggle",22)(28,"mat-date-range-picker",null,1),e.k0s()(),e.j41(30,"div",23)(31,"fuse-card",24,0)(33,"div",25),e.EFF(34,"Total User"),e.k0s(),e.j41(35,"div",26)(36,"p",27),e.EFF(37),e.k0s()()(),e.j41(38,"fuse-card",28,0)(40,"div",25),e.EFF(41,"Time Now"),e.k0s(),e.j41(42,"div",26)(43,"p",27),e.EFF(44),e.k0s()()()()(),e.j41(45,"section",29)(46,"div",30)(47,"div",31)(48,"label",32),e.EFF(49,"Search"),e.k0s(),e.j41(50,"div",33)(51,"div",34),e.qSk(),e.j41(52,"svg",35),e.nrm(53,"path",36),e.k0s()(),e.joV(),e.j41(54,"input",37),e.bIt("keyup",function(c){return e.eBV(n),e.Njj(o.applySearchFilter(c.target.value))}),e.k0s()(),e.j41(55,"div",38)(56,"button",39),e.nrm(57,"mat-icon",40),e.j41(58,"span",41),e.EFF(59,"Filter"),e.k0s(),e.nrm(60,"mat-icon",42),e.k0s()(),e.j41(61,"mat-menu",null,2)(63,"button",43),e.EFF(64,"User Profile"),e.k0s(),e.j41(65,"mat-menu",null,3)(67,"div",44)(68,"h1",45),e.EFF(69,"Choose User Profile"),e.k0s()(),e.j41(70,"div",46),e.DNE(71,$,4,2,"div",47),e.k0s()()()(),e.j41(72,"div",48),e.DNE(73,I,8,0,"div",49),e.j41(74,"div",50),e.DNE(75,Q,21,4,"mat-table",51),e.k0s(),e.DNE(76,W,5,0,"div",52),e.k0s(),e.nrm(77,"mat-paginator",53,4),e.k0s()()()()()}if(2&r){const n=e.sdS(29),s=e.sdS(62),c=e.sdS(66);e.R7$(22),e.Y8G("rangePicker",n)("formGroup",o.range),e.R7$(5),e.Y8G("for",n),e.R7$(10),e.SpI("",o.totalUser," User"),e.R7$(7),e.JRh(o.timeNow),e.R7$(12),e.Y8G("matMenuTriggerFor",s)("disabled",o.isLoading),e.R7$(7),e.Y8G("matMenuTriggerFor",c)("matMenuTriggerData",e.lJ4(16,R)),e.R7$(8),e.Y8G("ngForOf",o.profileItems),e.R7$(2),e.Y8G("ngIf",o.isLoading),e.R7$(2),e.Y8G("ngIf",!o.isLoading),e.R7$(),e.Y8G("ngIf",o.isNotDataFound&&!o.isLoading),e.R7$(),e.Y8G("pageSize",10)("pageSizeOptions",e.lJ4(17,G))("showFirstLastButtons",!0)}},dependencies:[C.Hl,y.US,y.El,b.g7,b.So,p.MD,p.Sq,p.bT,E.$,d.tP,d.Zl,d.tL,d.ji,d.cC,d.YV,d.iL,d.KS,d.$R,d.YZ,d.NB,S.An,m.YN,m.me,m.BC,m.cb,m.vS,h.Cn,h.kk,h.fb,h.Cp,g.Ou,g.iy,f.X6,f.bU,f.el,f.xR,f.IG,f.SG,u.RG,u.rl,u.nJ,u.MV,u.yw,m.X1,m.j4,m.JD],encapsulation:2})}}return a})()}])}}]);